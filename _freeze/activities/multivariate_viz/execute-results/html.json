{
  "hash": "cbc58d141a8fd12c539b1da983c5805c",
  "result": {
    "markdown": "---\ntitle: \"Multivariate Viz\"\nnumber-sections: true\nexecute: \n  warning: false\nfig-height: 2.75\nfig-width: 4.25\nfig-env: 'figure'\nfig-pos: 'h'\nfig-align: center\ncode-fold: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyverse)\nlibrary(ggplot2)\n```\n:::\n\n\n\n### The story {-}\n\nThough far from a perfect assessment of academic preparedness, SAT scores have historically been used as one measurement of a state's education system. The `education` dataset contains various education variables for each state:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Import and check out data\neducation <- read.csv(\"https://mac-stat.github.io/data/sat.csv\")\nhead(education)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       State expend ratio salary frac verbal math  sat  fracCat\n1    Alabama  4.405  17.2 31.144    8    491  538 1029   (0,15]\n2     Alaska  8.963  17.6 47.951   47    445  489  934 (45,100]\n3    Arizona  4.778  19.3 32.175   27    448  496  944  (15,45]\n4   Arkansas  4.459  17.1 28.934    6    482  523 1005   (0,15]\n5 California  4.992  24.0 41.078   45    417  485  902  (15,45]\n6   Colorado  5.443  18.4 34.571   29    462  518  980  (15,45]\n```\n:::\n:::\n\n\nA codebook is provided by Danny Kaplan who also made these data accessible:\n\n![](https://mac-stat.github.io/images/112/SATcodebook.png)\n\n\n### Exercise 1: SAT scores {-}\n\n#### Part a {-}\n\nConstruct a plot of how the average `sat` scores vary from state to state. (Just use 1 variable -- `sat` not `State`!)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(education, aes(x=sat))+\n  geom_histogram(bindwidth=20)\n```\n\n::: {.cell-output-display}\n![](multivariate_viz_files/figure-html/unnamed-chunk-3-1.png){width=408}\n:::\n:::\n\n\n#### Part b {-}\n\nSummarize your observations from the plot. Comment on the basics: range, typical outcomes, shape. (Any theories about what might explain this non-normal shape?)\n\nThe average SAT score ranges from 800 to 1150. The data seems to be unimodal, with the mode at about 890. The data is positively skewed. \n\n\n### Exercise 2: SAT Scores vs Per Pupil Spending & SAT Scores vs Salaries {-}\n\nThe first question we'd like to answer is: Can the variability in `sat` scores from state to state be partially explained by how much a state spends on education, specifically its per pupil spending (`expend`) and typical teacher `salary`?\n\n#### Part a {-}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Construct a plot of sat vs expend\nggplot(education, aes(x=expend, y=sat))+\n  geom_point()+\n  geom_smooth(method='lm')\n```\n\n::: {.cell-output-display}\n![](multivariate_viz_files/figure-html/unnamed-chunk-4-1.png){width=408}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Construct a plot of sat vs salary\nggplot(education, aes(x=salary, y=sat))+\n  geom_point()+\n  geom_smooth(method='lm')\n```\n\n::: {.cell-output-display}\n![](multivariate_viz_files/figure-html/unnamed-chunk-5-1.png){width=408}\n:::\n:::\n\n\n#### Part b {-}\n\nWhat are the relationship trends between SAT scores and spending? Is there anything that surprises you?\n\nIt is surprising: as expenditure per pupil increase, the average sat score seems to reduce. \n\n\n### Exercise 3: SAT Scores vs Per Pupil Spending *and* Teacher Salaries {-}\n\nConstruct *one* visualization of the relationship of `sat` with `salary` *and* `expend`. HINT: Start with just 2 variables and tweak that code to add the third variable. Try out a few things!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(education, aes(x=expend, y=sat, color=salary))+\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](multivariate_viz_files/figure-html/unnamed-chunk-6-1.png){width=408}\n:::\n:::\n\n\n\n\n### Exercise 4: Another way to Incorporate Scale {-}\n\nIt can be tough to distinguish color scales and size scales for quantitative variables. Another option is to *discretize* a quantitative variable, or basically cut it up into *categories*.\n\nConstruct the plot below. Check out the code and think about what's happening here. What happens if you change \"2\" to \"3\"?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(education, aes(y = sat, x = salary, color = cut(expend, 2))) + \n  geom_point() + \n  geom_smooth(se = FALSE, method = \"lm\")\n```\n:::\n\nIt cuts into 3 parts if you change 2 to 3: the general syntax for cut is cut(var_to_cut, number_of_cuts)\n\n\nDescribe the trivariate relationship between `sat`, `salary`, and `expend`.\n\nWith an increase in teacher salary, the expenditure per student also increases. As these two explanatory variables increase, the SAT score decreases: first steeply, and then more gradually. \n\n\n### Exercise 5: Finally an Explanation {-}\n\nIt's strange that SAT scores *seem* to decrease with spending. But we're leaving out an important variable from our analysis: the fraction of a state's students that actually take the SAT. The `fracCat` variable indicates this fraction: `low` (under 15% take the SAT), `medium` (15-45% take the SAT), and `high` (at least 45% take the SAT).\n\n#### Part a {-}\n\nBuild a univariate viz of `fracCat` to better understand how many states fall into each category.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(education, aes(x=fracCat))+\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](multivariate_viz_files/figure-html/unnamed-chunk-8-1.png){width=408}\n:::\n:::\n\n\nThe number of states that fall into the category of 15% or less students take the SAT is about 21. The number of states that fall into the category of 15% to 45% of students take the SAT is about 7. The number of states that fall into the category of 45% to 100% of  students take the SAT is about 22. \n\n#### Part b {-}\n\nBuild 2 bivariate visualizations that demonstrate the relationship between `sat` and `fracCat`. What story does your graphic tell and why does this make contextual sense?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(education, aes(x=fracCat, y=sat))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](multivariate_viz_files/figure-html/unnamed-chunk-9-1.png){width=408}\n:::\n:::\n\nWhen the fraction of students that take the sat is lesser, the median average SAT score is higher. \n\n\n#### Part c {-}\n\nMake a trivariate visualization that demonstrates the relationship of `sat` with `expend` AND `fracCat`. Highlight the differences in `fracCat` groups through color AND unique trend lines. What story does your graphic tell?\\\nDoes it still seem that SAT scores decrease as spending increases?\n\n\n::: {.cell}\n\n:::\n\n\n#### Part d {-}\n\nPutting all of this together, explain this example of **Simpsonâ€™s Paradox**. That is, why did it appear that SAT scores decrease as spending increases even though the *opposite* is true?\n\n\n### Exercise 5: Finally an Explanation {-}\n\n#### Part a {-}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(education, aes(x = fracCat)) + \n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](multivariate_viz_files/figure-html/unnamed-chunk-11-1.png){width=408}\n:::\n:::\n\n\n#### Part b {-}\n\nThe more students in a state that take the SAT, the lower the average scores tend to be. This is probably related to self-selection.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(education, aes(x = sat, fill = fracCat)) + \n  geom_density(alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](multivariate_viz_files/figure-html/unnamed-chunk-12-1.png){width=408}\n:::\n:::\n\n\n#### Part c {-}\n\nWhen we control for the fraction of students that take the SAT, SAT scores *increase* with expenditure.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(education, aes(y = sat, x = expend, color = fracCat)) + \n  geom_point() + \n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](multivariate_viz_files/figure-html/unnamed-chunk-13-1.png){width=408}\n:::\n:::\n\n\nThus, fracCat seems to be a confounding variable that conforms to Simpson's paradox (switch the relationship between expend and sat). \n\n#### Part d {-}\n\nStudent participation tends to be lower among states with lower expenditures (which are likely also the states with higher ed institutions that haven't historically required the SAT). Those same states tend to have higher SAT scores because of the self-selection of who participates.\n\n\n</details>\n",
    "supporting": [
      "multivariate_viz_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}